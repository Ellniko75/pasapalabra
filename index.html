<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="stylesheet" href="styles.css" />
    <title>pasapalabra</title>
  </head>
  <body>
    <div class="container">
      <div class="letters">A</div>
      <div class="letters">B</div>
      <div class="letters">C</div>
      <div class="letters">D</div>
      <div class="letters">E</div>
      <div class="letters">F</div>
      <div class="letters">G</div>
      <div class="letters">H</div>
      <div class="letters">I</div>
      <div class="letters">J</div>
      <div class="letters">K</div>
      <div class="letters">L</div>
      <div class="letters">M</div>
      <div class="letters">N</div>
      <div class="letters">O</div>
      <div class="letters">p</div>
      <div class="letters">q</div>
      <div class="letters">r</div>
      <div class="letters">s</div>
      <div class="letters">t</div>
      <div class="letters">u</div>
      <div class="letters">v</div>
      <div class="letters">w</div>
      <div class="letters">x</div>
      <div class="letters">y</div>
      <div class="letters">z</div>
      <section class="questions">
        <h2 class="showQuestion"></h2>
        <p class="showData"></p>
        <input class="inputAnswer" type="text" name="" id="" placeholder="" />
        <button class="skipButton">SKIP</button>
      </section>
    </div>
  </body>
  <script>
    const questionsAndAnswers = [
      {
        q: "Cual es el segundo nombre de Messi",
        a: ["andres"],
        answered: false,
        data: "Empieza por A",
      },
      {
        q: "Cual es el pais con más copas del mundo",
        a: ["brazil", "brasil"],
        answered: false,
        data: "Empieza por B",
      },
      {
        q: "Cuál es el país más poblado del mundo",
        a: ["china"],
        answered: false,
        data: "Empieza por C",
      },
      {
        q: "Funcion matemática que muestra el ratio de cambio",
        a: ["derivada", "derivadas"],
        answered: false,
        data: "Empieza por D",
      },
      {
        q: "Un músculo potente que se encuentra en la parte anterior del cuello. La palabra es más larga que la mierda",
        a: ["esternocleidomastoideo"],
        answered: false,
        data: "Empieza por E",
      },
      {
        q: "Compañía de videojuegos responsable por éxitos como dark souls y elden ring",
        a: ["fromsoftware", "from software"],
        answered: false,
        data: "Empieza por f",
      },
      {
        q: "Modelo astronómico que se utilizaba previamente",
        a: ["geocentrismo", "geocentrista"],
        answered: false,
        data: "Empieza por G",
      },
      {
        q: "Atomo producido por la fusión en las estrellas",
        a: ["helio"],
        answered: false,
        data: "Empieza por H",
      },
      {
        q: "Saga de juegos de la cual es originaria el spinoff de 'Persona'",
        a: ["shin megami tensei", "megami tensei"],
        answered: false,
        data: "Contiene la I",
      },
      {
        q: "País de donde es originaria 'Petra'",
        a: ["jordania"],
        answered: false,
        data: "Empieza por J",
      },
      {
        q: "Unidad de masa",
        a: ["kilo", "kilogramo", "kilos", "kilogramos"],
        answered: false,
        data: "Empieza por K",
      },
      {
        q: "Suma de infinitos sumandos que dan el área bajo una línea de una función",
        a: ["integral", "integrales"],
        answered: false,
        data: "Contiene la L",
      },
      {
        q: "Juego first person shooter pionero en el género",
        a: ["doom"],
        answered: false,
        data: "Contiene M",
      },
    ];
    const skipButton = document.querySelector(".skipButton");
    const inputAnswer = document.querySelector(".inputAnswer");
    const h2Question = document.querySelector(".showQuestion");
    const letters = document.querySelectorAll(".letters");
    const showData = document.querySelector(".showData");
    let index = -1;
    moveForward();
    markLetterAscurrent(index, letters, questionsAndAnswers);

    inputAnswer.addEventListener("keydown", (e) => {
      const { key } = e;

      if (key == "Enter") {
        if (inputAnswer.value == "") {
          moveForward();
          markLetterAscurrent(index, letters);
          return;
        }
        //mark as answered
        questionsAndAnswers[index].answered = true;
        const userAnswer = e.target.value;
        const correctAnswer = questionsAndAnswers[index].a;

        //correct answer
        if (answerIsCorrect(userAnswer, index)) {
          letters[index].style.backgroundColor = "green";
        } else {
          //incorrect answer
          letters[index].style.backgroundColor = "red";
        }
        moveForward();
        markLetterAscurrent(index, letters);

        if (isFinished(questionsAndAnswers)) {
          alert("listo");
          index = -23;
          return;
        }
      }
    });

    skipButton.addEventListener("click", () => {
      moveForward();
      markLetterAscurrent(index, letters);
    });

    function moveForward() {
      const newIndex = getNextIndex(index, questionsAndAnswers);
      index = newIndex;
      const newQuestion = questionsAndAnswers[index];
      h2Question.textContent = newQuestion.q;
      inputAnswer.value = "";
      showData.textContent = newQuestion.data;
    }

    function answerIsCorrect(answer, index) {
      const correctAnswers = questionsAndAnswers[index].a;
      return correctAnswers.includes(answer.toLowerCase());
    }

    function isFinished(questionsAndAnswers) {
      for (const qa of questionsAndAnswers) {
        if (!qa.answered) {
          return false;
        }
      }
      return true;
    }

    function getNextIndex(index, questionsAndAnswers) {
      if (index == -1) return 0;
      let currentIndex = index;
      while (true) {
        if (currentIndex == questionsAndAnswers.length - 1) {
          currentIndex = 0;
        } else {
          currentIndex++;
        }
        //if not answered yet, return that index
        if (!questionsAndAnswers[currentIndex].answered) {
          return currentIndex;
        }
      }
    }
    function markLetterAscurrent(index, arrOfLetters) {
      arrOfLetters.forEach((element) => {
        if (element.style.backgroundColor == "orange") {
          element.style.backgroundColor = "blanchedalmond";
        }
      });
      arrOfLetters[index].style.backgroundColor = "orange";
    }
  </script>
</html>
